\chapter{Analysis Strategy}%
\label{ch:strategy}
In the previous chapter the process of reconstruction and selection was
described. With the objects required for this analysis reconstructed and an
event selection in place an analysis strategy is formed in order to maximise the
signal strength of the VH(bb) process and yield a robust result that is well
understood in terms of modelling and systematic errors. In this chapter that
strategy will be detailed, first the categorisation into analysis regions will
be defined, next the multi-variate algorithm that is used to generate some of
the distributions entering into the profile-likelihood fit will be explained.
Plots of the data versus Monte-Carlo prediction will then be shown in order to
build a picture of the pre-fit status of the agreement. Finally a series of
cross-checks which are used to validate the methods of the analysis will be
explained.

The author's contributions include studying the behaviour of the
profile-likelihood fit with the inclusion of these regions, which are new in
this round of the analysis and making comparisons between the 80~\invfb and
140~\invfb datasets). Contributions also include the training of the
multi-variate classification algorithm with the inclusion of new input variables
with respect to the previous version of the algorithm.

\section{Categorisation into Analysis Regions}
\label{sec:ana-regions}

Events which pass the selection detailed in table~\ref{tab:event-selection} are
categorised into several regions for analysis. Firstly they are split into what
are known as medium ($75 - 150 \GeV$), high ($150 - 250 \GeV$) and extreme ($ >
250 \GeV$) $p_T^{V}$. Events are further categorised by jet multiplicity, all
jets are required by the selection to have at least two jets, categories are
defined for events with exactly two, or exactly three jets. In the 2--lepton
channel there is a requirement of three or more jets but when referring to all
three channels at once categorisation is referred to as simply 3-jet or 2-jet.

Furthermore events are categorised into a so-called signal region which is
straddled either side by two control regions. This categorisation is achieved
via continuous cuts defined in the $\Delta R(b, \bar{b})$~---~$p_T^{V}$ plane,
they are chosen to maximise the signal purity in the signal region and are shown
for the 1--lepton channel in figure~\ref{fig:drbb-crs}.
\input{06-analysis-strategy/drbb-cuts}
The control regions either side of the signal region are known as the
high-$\Delta R(b, \bar{b})$ and low-$\Delta R(b, \bar{b})$ regions, shortened to
CRHigh and CRLow respectively.

A 3D representation of the regions defined when combining these three
categorisations can be seen in figure~\ref{fig:analysis-categories}.
\input{06-analysis-strategy/analysis-cube}
Note that not all regions of the cube are populated with events in every channel, the medium
$p_T^V$ region is only filled for the 2--lepton channel.

\subsection{Top \texorpdfstring{$e \mu$}{e mu} control region}%
\label{sec:topemucr}

One more region exists only in the 2--lepton channel, it is obtained by inverting the
requirement of two same flavour leptons, requiring two opposite flavour leptons
instead, and keeping all other selection criteria the same. This region contains
almost all $t\bar{t}$ and single top processes (whose Feynman diagrams belong to
the same sum) matching very closely the number of expected events of each of
these backgrounds in the 2--lepton channel. This region is therefore called the
top $e \mu$ control region. The data from this control region can be used as a
prediction for the number of top process events in the 2--lepton channel once
multiplied by a scale factor which accounts for differences in normalisation.
Since data are used as the prediction for these events modelling of shape or
migration between control regions becomes unnecessary.

Plots of top e-mu control region

\section{Composition of Analysis Regions}

This section will detail the composition of each analysis region in terms of
background and signal processes. For all regions the signal process is
$VH~\rightarrow~b\bar{b}$, the prediction for which comes from events generated
using \textsc{Powheg MiNLO}~+~\textsc{Pythia~8} for quark initiated processes
and \textsc{Powheg}~+~\textsc{Pythia~8} for gluon initiated processes as can be
seen in table~\ref{tab:sigMC}.
 
\input{06-analysis-strategy/signal-MC}

The 0--lepton channel contains the  Z+ jets, W + jets, top quark and diboson
backgrounds. The Z + jets background dominates the mixture in the 2-jet category
across signal and control regions. In the 3-jet category the top-quark processes
dominate apart from in the low $\Delta R(b, \bar{b})$ region. There is very
little signal contamination in the control regions. As can be seen in
table~\ref{tab:bkgMC} V + jets events are generated using \textsc{Sherpa~2.2.1},
top quark events are generated using \textsc{Powheg}~+~\textsc{Pythia~8} and
diboson events are generated also using \textsc{Sherpa~2.2.1}, this is true for
these backgrounds across all channels where a Monte-Carlo prediction is used.

\input{06-analysis-strategy/background-MC}

The 1--lepton channel contains the W + jets, Z+ jets, top quark, diboson and multijet
backgrounds where multijet is the name given to backgrounds arising from QCD
processes. The channel is dominated by a mixture of W + jets and top quark
processes, the high $\Delta R(b, \bar{b})$ control region has a higher purity of
top quark processes whereas the low $\Delta R(b, \bar{b})$ control region has a
high purity of W + jets background. Contribution from multijet and Z + jets is
small across all regions, and similarly to in the 0--lepton channel the diboson
background is almost all contained in the signal region.

The 2--lepton channel contains the Z + jets, top quark and diboson backgrounds.
The Z + jets background dominates across all regions particularly in both
$\Delta R(b, \bar{b})$ control regions. Predictions for the top quark processes
are taken from the top $e \mu$ control region described in
section~\ref{sec:topemucr}. Given that these predictions come from data, the
importance of a good understanding of the remaining large background, Z + jets,
is crucial to the performance of the analysis.

\section{Multi-variate Event Classification}%
\label{sec:mva}

The signal regions in all channels enter into the profile-likelihood fit as
distributions generated by a multi-variate analysis. The multi-variate algorithm
used to generate this distribution is a BDT trained to separate
$VH~\rightarrow~b\bar{b}$ from events coming from any other source. Although in
the profile-likelihood fit only the signal region is input as a distribution of
BDT scores, the BDT itself is trained on the combination of all $\Delta R(b,
\bar{b})$ regions and takes place before the categorisation into ranges of
$p_T^V$. Apart from this all of the analysis selection criteria defined in
section~\ref{sec:selection} are applied before training. Training is carried out
separately for each lepton channel and jet multiplicity, a single split at
$150~\GeV$ is used in the 2--lepton channel resulting in eight separate regions
for training as in table~\ref{tab:training-regions}.
\input{06-analysis-strategy/training-regions}
Training regions do not match the signal regions in terms of selection in order
to ensure that the training is as robust as possible to statistical
fluctuations. In tests it has been shown that there is significant evidence of
over-training when training is performed on the signal region (see
appendix~\ref{app:over-training}).



Table~\ref{tab:MVAinputs} shows which variables are used as inputs to algorithm
in each analysis channel. Inputs are carefully chosen in order to maximise the
performance of the algorithm. 

and table~\ref{tab:BDTSetup} shows the choice of
hyper-parameters for the algorithm as described in \textsc{tmva}~\cite{TMVA} the
toolkit for multi-variate analysis which is built into
\textsc{ROOT}~\cite{ROOT}, and was used for training this algorithm.
\input{06-analysis-strategy/MVA-inputs}
\input{06-analysis-strategy/bdt-hps}
Distributions of the inputs to the BDT in 2-jet, high $p_T^V$ region
are shown in
figures~\ref{fig:bdtinputs-0lep},~\ref{fig:bdtinputs-1lep},~\ref{fig:bdtinputs-2lep}
for the 0--, 1-- and 2--lepton channels respectively. In all channels it can be
seen that a high level separation power in one dimension can be obtained from
the $m(b,\bar{b})$ and $\Delta R (b, \bar{b})$ distributions which are
correlated. In the 0--lepton channel a moderate level of separation can be
obtained from the $\Delta \eta(b, \bar{b})$, $E_T^{miss}$ and $p_T(b_2)$ also.
In the 1--lepton channel $\min(\Delta\phi(\ell,jet))$, $m_{\text{top}}$ and
$p_T(b_2)$ provide the next best one dimensional separation. In the 2--lepton
channel it is the $\cos{\theta(\ell^-,Z)}$, $E_T^{miss}\text{--significance}$,
$\Delta \eta(V, H)$ and $p_T(b_2)$ that provide next best separation.
\input{06-analysis-strategy/2jet-150pTV-input-distributions}

- What is the performance like?

- Transformation

\section{Pre-fit plots}
\label{sec:prefit}

This section shows the pre-fit distributions of the Monte-Carlo prediction
versus the data in every analysis region that enters into the profile-likelihood
fit. Figures~\ref{fig:0lep-2jet-prefit},~\ref{fig:0lep-3jet-prefit} show the
distributions in the 0--lepton channel in the 2--jet and 3--jet regions
respectively. Figures~\ref{fig:1lep-2jet-prefit},~\ref{fig:1lep-3jet-prefit} show the
distributions in the 1--lepton channel in the 2--jet and 3--jet regions
respectively. Figures~\ref{fig:2lep-2jet-prefit},~\ref{fig:2lep-3pjet-prefit} show the
distributions in the 2--lepton channel in the 2--jet and 3+--jet regions
respectively.
\input{06-analysis-strategy/0lep-2jet-prefit}
\input{06-analysis-strategy/0lep-3jet-prefit}
\input{06-analysis-strategy/1lep-2jet-prefit}
\input{06-analysis-strategy/1lep-3jet-prefit}
\input{06-analysis-strategy/2lep-2jet-prefit}
\input{06-analysis-strategy/2lep-3pjet-prefit}

\section{Analysis Cross-checks}

The final elements of the analysis strategy are a series of cross-checks that
are designed to ensure the methodology is robust. Firstly there is the di-jet
mass fit, also known as the $m_{bb}$ fit. This cross-check is designed to ensure
that the multi-variate analysis has not introduced any biases that have changed
the result so much that is statistically incompatible with a version of the
analysis that does not use the BDT. This cross-check is performed by simply
taking the $m_{bb}$ distribution in place of the BDT distribution in the
profile-likelihood fit.

The second cross-check is a measurement of the diboson process. Diboson final
states arising from proton-proton collisions are well understood and in this
case are being treated as a standard candle~\footnote{A standard candle is an
  astronomical object with a known absolute luminosity that can be used to aid
  astronomical measurements. }. The rationale here is that if the analysis
methodology produces a measurement of the diboson process that is in agreement
with the Standard Model prediction, and therefore existing measurements, then
the methodology itself has not introduced unexpected effects on the result.




